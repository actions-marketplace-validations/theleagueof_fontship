#!/usr/bin/env @PYTHON@

__version__ = "@VERSION@"

# This is inscruitable, but basically allows us to take advantage of automake
# knowing where system stuff is without having to process the source in two
# stages to get the final answer here. All this to know where on the system we
# are currently installed!
SRCDIR = "@datarootdir@/fontship/".replace("${prefix}", "@prefix@")

import sys
sys.path.append("@pythondir@/".replace("${prefix}", "@prefix@"))

import click
import fontship
import subprocess

@click.command()
@click.version_option(__version__)
@click.pass_context
@click.argument('command')
@click.argument('args', nargs=-1)

def fontship(ctx, command, args):
    """Execute any fontship supported subcommand COMMAND."""
    if command == "make":
        # TODO: Check if a local Makefile exists first, and run it with an extra include if so
        process = subprocess.run([command, '-f', SRCDIR + "Makefile"] + list(args))
            #, stdout=subprocess.PIPE, stderr=subprocess.PIPE, universal_newlines=True)
        process
    else:
        print("unknown command, try 'make'")

if __name__ == '__main__':
    fontship()

# vim: ft=python
